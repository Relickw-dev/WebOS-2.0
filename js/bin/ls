// File: js/bin/ls.js
import { syscall } from '../kernel/syscalls.js';

/**
 * Logica pentru comanda 'ls'.
 * @param {string[]} args - Argumentele comenzii (ex: ['/path/to/dir']).
 * @param {object} context - Contextul procesului (cwd, stdout, etc.).
 */
export default async function lsLogic(args, context) {
    const { cwd, stdout } = context;
    let path = args[0] || cwd;

    try {
        const entries = await syscall('vfs.readDir', { path });
        const output = entries.join('\n');
        stdout.write({ message: output });
        return 0; // Exit code 0 for success
    } catch (e) {
        stdout.write({ type: 'error', message: `ls: cannot access '${path}': ${e.message}` });
        return 1; // Exit code 1 for error
    }
}